<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>

<pre style="margin: 0; line-height: 125%">                
<span style="color: #007700">&lt;RichEditBox</span> <span style="color: #0000CC">x:Name=</span><span style="background-color: #fff0f0">&quot;REBCustom&quot;</span> <span style="color: #0000CC">Width=</span><span style="background-color: #fff0f0">&quot;800&quot;</span> <span style="color: #0000CC">Height=</span><span style="background-color: #fff0f0">&quot;200&quot;</span> <span style="color: #0000CC">Loaded=</span><span style="background-color: #fff0f0">&quot;REBCustom_Loaded&quot;</span> <span style="color: #0000CC">Unloaded=</span><span style="background-color: #fff0f0">&quot;REBCustom_Unloaded&quot;</span><span style="color: #007700">/&gt;</span>
   
-------
<span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">ContextFlyout_Opening</span>(<span style="color: #333399; font-weight: bold">object</span> sender, <span style="color: #333399; font-weight: bold">object</span> e)
{
    CommandBarFlyout myFlyout = sender <span style="color: #008800; font-weight: bold">as</span> CommandBarFlyout;
<span style="color: #008800; font-weight: bold">if</span> (myFlyout.Target == REBCustom)
    {
        AppBarButton myButton = <span style="color: #008800; font-weight: bold">new</span> AppBarButton();
        myButton.Command = <span style="color: #008800; font-weight: bold">new</span> StandardUICommand(StandardUICommandKind.Share);
        myFlyout.PrimaryCommands.Add(myButton);
    }
}

<span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">REBCustom_Loaded</span>(<span style="color: #333399; font-weight: bold">object</span> sender, RoutedEventArgs e)
{
    REBCustom.ContextFlyout.Opening += ContextFlyout_Opening;
}

<span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">REBCustom_Unloaded</span>(<span style="color: #333399; font-weight: bold">object</span> sender, RoutedEventArgs e)
{
    REBCustom.ContextFlyout.Opening -= ContextFlyout_Opening;
}
</pre>

</body>
</html>